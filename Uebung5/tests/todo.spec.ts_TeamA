import { expect, Page, test } from '@playwright/test';

test.describe('TodoMVC Tests', () => {
    test.beforeEach(async ({ page }: { page: Page }) => {
        await page.goto('https://demo.playwright.dev/todomvc/');
    });

    // Demo Test
    test("Demo Test", async ({ page }: { page: Page }) => {
        const newTodoInput = page.getByPlaceholder('What needs to be done?');
        await newTodoInput.fill('Mein erstes Todo');
        await newTodoInput.press('Enter');

        await expect(page.getByText('Mein erstes Todo')).toBeVisible();
    });


    // [HAHR, PRSE] Ein TODO der Liste hinzufügen
    test("Ein neues Todo wird hinzugefügt", async ({ page }) => {
        await page.goto('https://demo.playwright.dev/todomvc/#/');
        await page.getByRole('textbox', { name: 'What needs to be done?' }).click();
        await page.getByRole('textbox', { name: 'What needs to be done?' }).fill('Kochen');
        await page.getByRole('textbox', { name: 'What needs to be done?' }).click();
        await page.getByRole('textbox', { name: 'What needs to be done?' }).press('Enter');
    });

    // [HAHR, PRSE] Mehrere TODOs der Liste hinzufügen
    test("Mehrere TODOs der Liste hinzufügen", async ({ page }) => {
        await page.goto('https://demo.playwright.dev/todomvc/#/');
        await page.getByRole('textbox', { name: 'What needs to be done?' }).click();
        await page.getByRole('textbox', { name: 'What needs to be done?' }).fill('Wischen');
        await page.getByRole('textbox', { name: 'What needs to be done?' }).press('Enter');
        await page.getByRole('textbox', { name: 'What needs to be done?' }).fill('Bügeln');
        await page.getByRole('textbox', { name: 'What needs to be done?' }).press('Enter');
        await page.getByRole('textbox', { name: 'What needs to be done?' }).fill('Einkaufen');
        await page.getByRole('textbox', { name: 'What needs to be done?' }).press('Enter');
    });

    // [HAHR, PRSE] Eine Checkbox bei einem TODO anhaken und wieder rückgängig machen
    test("Eine Checkbox bei einem TODO anhaken und wieder rückgängig machen", async ({ page}) => {
        await page.goto('https://demo.playwright.dev/todomvc/#/');
        await page.getByRole('textbox', { name: 'What needs to be done?' }).click();
        await page.getByRole('textbox', { name: 'What needs to be done?' }).fill('Einkaufen');
        await page.getByRole('textbox', { name: 'What needs to be done?' }).press('Enter');
        await page.getByRole('listitem').filter({ hasText: 'Einkaufen' }).getByLabel('Toggle Todo').check();
        await page.getByRole('listitem').filter({ hasText: 'Einkaufen' }).getByLabel('Toggle Todo').uncheck();
    });

    // [HAHR, PRSE] Abfrage Aktiver TODOs
    test("Abfrage Aktiver TODO", async ({ page }) => {
        await page.goto('https://demo.playwright.dev/todomvc/#/');
        await page.getByRole('textbox', { name: 'What needs to be done?' }).click();
        await page.getByRole('textbox', { name: 'What needs to be done?' }).fill('Bügeln');
        await page.getByRole('textbox', { name: 'What needs to be done?' }).press('Enter');
        const counter = page.locator('.todo-count');
        const text = await counter.textContent();
        console.log(text);
    });
});
